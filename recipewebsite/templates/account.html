{% extends 'base.html' %}
{% block content %}

<section class="account-section">
	<div class="container py-5">
		<div class="row">
			<div class="col">
				<nav aria-label="breadcrumb" class="breadcrumb-custom mb-4">
					<ol class="breadcrumb mb-0">
						<li class="breadcrumb-item"><a href="{% url 'index' %}"><i class="bi bi-home"></i> Início</a></li>
						<li class="breadcrumb-item active" aria-current="page">
							<i class="bi bi-user"></i> Meu Perfil
						</li>
					</ol>
				</nav>
			</div>
		</div>

		<div class="row">
			<div class="col-lg-4">
				<div class="card profile-card mb-4">
					<div class="card-body text-center">
						<div class="avatar-wrapper mb-3">
							<img
								src="{{ user.avatar.url }}"
								alt="avatar"
								class="avatar-img"
							/>
						</div>
						<h4 class="profile-name">{{ user.username }}</h4>
						{% if user.bio %}
						<p class="profile-bio">{{ user.bio }}</p>
						{% endif %}
						{% if user.city %}
						<p class="profile-location"><i class="bi bi-map-marker-alt"></i> {{ user.city.city }}</p>
						{% endif %}
						<div class="profile-stats mb-3">
							<div class="stat-item">
								<span class="stat-value">{{ recipes.count }}</span>
								<span class="stat-label">Receitas</span>
							</div>
						</div>
						<div class="d-flex justify-content-center gap-2 mb-2">
							<a href="{% url 'edit' %}" class="btn btn-primary">
								<i class="bi bi-edit"></i> Editar Perfil
							</a>
							<a href="{% url 'create_recipe' %}" class="btn btn-success">
								<i class="bi bi-plus"></i> Nova Receita
							</a>
							<a href="{% url 'password_change' %}" class="btn btn-primary">
								<i class="bi bi-key"></i> Alterar Senha
							</a>
						</div>
					</div>
				</div>
				
				{% if socials %}
				<div class="card social-card mb-4">
					<div class="card-body">
						<h6 class="card-title mb-3"><i class="bi bi-share-alt"></i> Redes Sociais</h6>
						<ul class="social-list">
							{% for social in socials %}
							<li class="social-item">
								<a href="{{ social.link }}" target="_blank" class="social-link">
									<i class="{{ social.icon.html_class }}"></i>
									<span>{{ social.profile_name }}</span>
								</a>
							</li>
							{% endfor %}
						</ul>
					</div>
				</div>
				{% endif %}
			</div>
			<div class="col-lg-8">
				<div class="card info-card mb-4">
					<div class="card-body">
						<h5 class="card-title mb-4"><i class="bi bi-info-circle"></i> Informações Pessoais</h5>
						
						<div class="info-row">
							<div class="info-label">
								<i class="bi bi-user"></i> Nome Completo
							</div>
							<div class="info-value">
								{{ user.first_name }} {% if user.last_name %}{{ user.last_name }}{% endif %}
							</div>
						</div>

						<div class="info-row">
							<div class="info-label">
								<i class="bi bi-envelope"></i> Email
							</div>
							<div class="info-value">
								{{ user.email }}
							</div>
						</div>

						{% if user.city %}
						<div class="info-row">
							<div class="info-label">
								<i class="bi bi-map-marker-alt"></i> Cidade
							</div>
							<div class="info-value">
								{{ user.city.city }}
							</div>
						</div>
						{% endif %}

						<div class="info-row">
							<div class="info-label">
								<i class="bi bi-calendar-plus"></i> Membro desde
							</div>
							<div class="info-value">
								{{ user.date_joined|date:"d/m/Y" }}
							</div>
						</div>

						{% if user.last_login %}
						<div class="info-row">
							<div class="info-label">
								<i class="bi bi-clock"></i> Último acesso
							</div>
							<div class="info-value">
								{{ user.last_login|date:"d/m/Y H:i" }}
							</div>
						</div>
						{% endif %}

					</div>
				</div>
				
				<div class="card recipes-card">
					<div class="card-body">
						<div class="d-flex justify-content-between align-items-center mb-4">
							<h5 class="card-title mb-0">
								<i class="bi bi-utensils"></i> Minhas Receitas 
								<span class="badge bg-primary">{{ recipes.count }}</span>
							</h5>
							<a href="{% url 'create_recipe' %}" class="btn btn-sm btn-success">
								<i class="bi bi-plus"></i> Nova Receita
							</a>
						</div>
						
						{% if recipes %}
						<div class="row">
							{% for recipe in recipes %}
							<div class="col-md-6 mb-3">
								{% include 'recipe-card.html' %}
							</div>
							{% endfor %}
						</div>
						{% else %}
						<div class="empty-state">
							<i class="bi bi-book-open"></i>
							<p>Você ainda não publicou nenhuma receita</p>
							<a href="{% url 'create_recipe' %}" class="btn btn-primary">
								<i class="bi bi-plus"></i> Criar Minha Primeira Receita
							</a>
						</div>
						{% endif %}
					</div>
				</div>
			</div>
		</div>
	</div>
</section>
{% endblock %}
